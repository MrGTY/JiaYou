<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.zhaojisys.dao.user.OilSumMapper">
	<!--燃油站点查询当月燃油交易额，交易量,可提取額 -->
	<select id="findOilSum" resultType="Oilrecord">
		select sum(o.income) AS income,count(o.id) AS id,e.amountDrawn as remaining
		from oilrecord AS o,extractapply AS e
		where
		date_format(operationTime,'%Y-%m')=date_format(now(),'%Y-%m') and
		o.gsId=#{gsId} and e.gsId=#{gsId} and e.status=#{status} 
		
	</select>
	<!--燃油站点查询全部燃油交易额，交易量,可提取額 -->
		<select id="findOilSumMonth" resultType="Oilrecord">
		select sum(o.income) AS income,count(o.id) AS id,e.amountDrawn as remaining
		from oilrecord AS o,extractapply AS e
		where
		o.gsId=#{gsId} and e.gsId=#{gsId} and e.status=#{status} 	
	</select>
	<select id="findOilSum1" resultType="Oilrecord">
		select sum(o.income) AS income,count(o.id) AS id,e.amountDrawn as remaining,o.operationTime as operationTime
		from oilrecord AS o,extractapply AS e
		where
		date_format(operationTime,'%Y-%m')=date_format(now(),'%Y-%m') and
		o.gsId=#{gsId} and e.gsId=#{gsId} and e.status=#{status} 	
		GROUP BY
		DATE(o.operationTime)
	</select>
	<!--燃油站点查询全部燃油交易额，交易量,可提取額 -->
		<select id="findOilSumMonth1" resultType="Oilrecord">
		select sum(o.income) AS income,count(o.id) AS id,e.amountDrawn as remaining,o.operationTime as operationTime
		from oilrecord AS o,extractapply AS e
		where
		o.gsId=#{gsId} and e.gsId=#{gsId} and e.status=#{status} 	
		
	</select>
	<!--燃油站点查询年度燃油交易额，交易量,可提取額 -->
	<select id="findOilSumYear" resultType="Oilrecord">
		select sum(o.income) AS income,count(o.id) AS id,e.amountDrawn as remaining,o.operationTime as operationTime
		from oilrecord AS o,extractapply AS e
		where
		date_format(operationTime,'%Y')=date_format(now(),'%Y') and
		o.gsId=#{gsId} and e.gsId=#{gsId} and e.status=#{status} 
		group by
		date_format(operationTime, '%Y-%m')	
	</select>
	<!--燃油站点查询年度燃油交易额，交易量,可提取額 -->
		<select id="findOilSumYear1" resultType="Oilrecord">
		select sum(o.income) AS income,count(o.id) AS id,e.amountDrawn as remaining,o.operationTime as operationTime
		from oilrecord AS o,extractapply AS e
		where
		date_format(operationTime,'%Y')=date_format(now(),'%Y') and
		o.gsId=#{gsId} and e.gsId=#{gsId} and e.status=#{status} 	
		group by
		date_format(operationTime, '%Y-%m')
	</select>
	
</mapper>